{#
Services Section Component for Craft CMS 5

Uses entry fields:
- title: string (required)
- subtitle: string (optional)
- description: string (optional)
- text: Redactor field (optional)
- services: Matrix field with service entries
- backgroundColor: Color field, default: 'soft'
- svgVariant: number 1-9 or 'none', default: 1
- columns: number (2, 3, or 4), default: 2
#}

{% import '_partials/theme-macros.twig' as theme %}
{% import '_partials/ui-macros.twig' as ui %}

{% set background = entry.backgroundColor.value ?? entry.backgroundColor ?? 'soft' %}
{% set svgVariant = entry.svgVariant.value ?? entry.svgVariant ?? 1 %}
{% set columns = entry.columns.value ?? entry.columns ?? 2 %}
{% set vars = theme.getThemeVars(background)|json_decode %}

<section class="py-16 relative overflow-hidden {{ vars.backgroundClass }}">
    {# SVG Background Shapes #}
    {{ ui.svgShapes(svgVariant, vars) }}

    <div class="max-w-7xl mx-auto px-4 lg:px-8 relative z-10">
        <div class="text-center mb-12">
            {{ ui.subtitle(entry.subtitle, vars.subtitleBgClass) }}

            <h2 class="text-4xl font-bold {{ vars.titleColorClass }} mb-6">
                {{ entry.heading }}
            </h2>
            {% if entry.description %}
                <div class="text-xl {{ vars.textColorClass }} mt-4 max-w-3xl mx-auto">
                    {{ entry.description }}
                </div>
            {% endif %}
            {% if entry.text %}
                <div class="content-styles max-w-3xl mx-auto text-lg {{ vars.textColorClass }}">
                    {{ entry.text }}
                </div>
            {% endif %}
        </div>

        {% if columns == 3 %}
            {% set gridClass = 'grid md:grid-cols-2 lg:grid-cols-3 gap-6' %}
        {% elseif columns == 4 %}
            {% set gridClass = 'grid md:grid-cols-2 lg:grid-cols-4 gap-6' %}
        {% else %}
            {% set gridClass = 'grid md:grid-cols-2 gap-8' %}
        {% endif %}

        <div class="{{ gridClass }}">
            {% if entry.services %}
                {% for service in entry.services %}
                    <div class="p-6 hover:shadow-soft transition-all text-white flex flex-col rounded-tl-[2.5rem] rounded-br-[2.5rem]" style="background-color: {{ service.color }}">
                        <h3 class="text-2xl font-semibold mb-3">{{ service.title }}</h3>
                        {% if service.text %}<div class="mb-4 flex-grow content-styles">{{ service.text }}</div>{% endif %}
                        {% if service.link %}
                            <a
                                href="{{ service.link.value }}"
                                class="inline-flex items-center text-white hover:text-white/80 transition-colors font-semibold group"
                            >
                                {{ service.link.label }}
                                <svg class="w-4 h-4 ml-2 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                </svg>
                            </a>
                        {% endif %}
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</section>